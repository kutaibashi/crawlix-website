---
import { Link, Search, BarChart3, FileCheck } from '@lucide/astro';

const workflowSteps = [
  {
    step: 1,
    title: 'Enter URL',
    description: 'Just paste any website URL and Crawlix will map the entire site structure automatically.',
    Icon: Link,
    color: 'sky',
  },
  {
    step: 2,
    title: 'Crawl & Analyze',
    description: 'Our engine crawls every page, running 97+ SEO checks in parallel. JavaScript sites supported.',
    Icon: Search,
    color: 'violet',
  },
  {
    step: 3,
    title: 'Review Issues',
    description: 'See all issues organized by priority. Filter by type, page, or severity. Export to CSV.',
    Icon: BarChart3,
    color: 'amber',
  },
  {
    step: 4,
    title: 'Export Reports',
    description: 'Generate white-label PDF reports with your branding. Share with clients or stakeholders.',
    Icon: FileCheck,
    color: 'emerald',
  },
];

const colorClasses = {
  sky: { bg: 'bg-sky-500', text: 'text-sky-400', border: 'border-sky-500', glow: 'shadow-sky-500/50' },
  violet: { bg: 'bg-violet-500', text: 'text-violet-400', border: 'border-violet-500', glow: 'shadow-violet-500/50' },
  amber: { bg: 'bg-amber-500', text: 'text-amber-400', border: 'border-amber-500', glow: 'shadow-amber-500/50' },
  emerald: { bg: 'bg-emerald-500', text: 'text-emerald-400', border: 'border-emerald-500', glow: 'shadow-emerald-500/50' },
};
---

<section class="py-20 sm:py-32 bg-gradient-to-b from-[#091a3d] via-[#0a1d42] to-[#091a3d]" id="how-it-works">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <!-- Section Header -->
    <div class="text-center animate-on-scroll">
      <span class="inline-block text-sm font-semibold text-sky-400 uppercase tracking-wider mb-4">
        How It Works
      </span>
      <h2 class="text-3xl font-bold tracking-tight text-white sm:text-4xl lg:text-5xl">
        From URL to report in
        <span class="gradient-text-blue">four steps</span>
      </h2>
      <p class="mt-4 text-lg text-slate-400 max-w-2xl mx-auto">
        No complex setup required. Just paste a URL and let Crawlix do the heavy lifting.
      </p>
    </div>

    <!-- Steps - Timeline Style -->
    <div class="mt-20 relative">
      <!-- Connecting line (desktop) -->
      <div class="absolute top-10 left-0 right-0 h-0.5 bg-gradient-to-r from-transparent via-slate-700 to-transparent hidden lg:block"></div>

      <div class="grid gap-12 lg:grid-cols-4 lg:gap-8 stagger-children">
        {workflowSteps.map(({ step, title, description, Icon, color }) => {
          const colors = colorClasses[color as keyof typeof colorClasses];

          return (
            <div class="relative group">
              {/* Step number with glow */}
              <div class="relative mb-6 flex justify-center lg:justify-start">
                <div class={`relative flex h-20 w-20 items-center justify-center rounded-2xl border-2 ${colors.border} bg-[#0e2655] text-3xl font-bold ${colors.text} transition-all duration-300 group-hover:scale-110 group-hover:shadow-lg ${colors.glow}`}>
                  {step}
                  {/* Pulse effect */}
                  <div class={`absolute inset-0 rounded-2xl ${colors.bg} opacity-0 group-hover:opacity-20 transition-opacity duration-300`}></div>
                </div>
              </div>

              {/* Icon badge */}
              <div class={`absolute top-14 left-1/2 lg:left-16 -translate-x-1/2 lg:translate-x-0 flex h-8 w-8 items-center justify-center rounded-full ${colors.bg} text-white shadow-lg`}>
                <Icon class="h-4 w-4" />
              </div>

              {/* Content */}
              <div class="text-center lg:text-left">
                <h3 class="text-xl font-semibold text-white mb-3">{title}</h3>
                <p class="text-slate-400 leading-relaxed">{description}</p>
              </div>

              {/* Arrow connector (mobile) */}
              {step < 4 && (
                <div class="flex justify-center mt-8 lg:hidden">
                  <svg class="h-8 w-8 text-slate-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
                  </svg>
                </div>
              )}
            </div>
          );
        })}
      </div>
    </div>

    <!-- Bottom CTA -->
    <div class="mt-20 text-center animate-on-scroll">
      <div class="inline-flex flex-col sm:flex-row items-center gap-4 p-6 rounded-2xl bg-[#0e2655]/50 border border-slate-800">
        <div class="text-left">
          <p class="text-white font-semibold">Ready to try it yourself?</p>
          <p class="text-sm text-slate-400">No account needed. Download and start crawling in seconds.</p>
        </div>
        <a href="/download" class="shrink-0 inline-flex items-center gap-2 rounded-lg bg-sky-600 px-6 py-3 font-semibold text-white hover:bg-sky-500 transition-colors">
          Download Free
          <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
          </svg>
        </a>
      </div>
    </div>
  </div>
</section>

<script>
  // Initialize scroll animations
  document.addEventListener('DOMContentLoaded', () => {
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
        }
      });
    }, observerOptions);

    document.querySelectorAll('.animate-on-scroll, .stagger-children').forEach(el => {
      observer.observe(el);
    });
  });
</script>
